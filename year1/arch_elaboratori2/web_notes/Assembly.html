<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Assembly</title>
  <link rel="stylesheet" href="https://stackedit.io/style.css" />
</head>

<body class="stackedit">
  <div class="stackedit__left">
    <div class="stackedit__toc">
      
<ul>
<li><a href="#assembly">Assembly</a>
<ul>
<li><a href="#compilazione">Compilazione</a></li>
<li><a href="#linking">Linking</a></li>
<li><a href="#loading">Loading</a></li>
<li><a href="#labels">Labels</a></li>
</ul>
</li>
</ul>

    </div>
  </div>
  <div class="stackedit__right">
    <div class="stackedit__html">
      <h1 id="assembly">Assembly</h1>
<h2 id="compilazione">Compilazione</h2>
<p>La fase di compilazione si occupa di tradurre un programma scritto in un linguaggio in un programma scritto in un altro linguaggio, Spesso si compila un linguaggio ad alto livello per farlo diventare un codice a basso livello o in linguaggio macchina</p>
<p>Quando si compila un codice si generano dei file oggetto, nei sistemi UNIX questi file sono composti da:</p>
<ol>
<li><strong>header</strong>: che descrive il contenuto dell’object file</li>
<li><strong>text segment</strong>: che contiene il codice macchina prodotto dall’assemblatore</li>
<li><strong>data segment</strong>: che contiene i dati «globali» necessari per l’esecuzione del programma.</li>
<li><strong>relocation information</strong>: che identifica le istruzioni e i dati che dipendono da indirizzi assoluti</li>
<li><strong>symbol table</strong>: che contiene i simboli (le label) locali e globali (da esportare)</li>
<li><strong>debug informations</strong>: Informazioni aggiuntive come ad esempio il mapping tra sorgente ad alto livello e codice macchina</li>
</ol>
<h2 id="linking">Linking</h2>
<p>Dopo la compilazione viene la fase di <strong>linking</strong> in cui si collegano i file oggetti e si produce un unico file eseguibile. In questa fase vengono risolti tutti i riferimenti e gli indirizzi relativi (indirizzi che dipendono dalla posizione in byte della label rispetto al modulo (file) a cui appartiene)</p>
<h2 id="loading">Loading</h2>
<p>Nella fase di loading si carica il programma in memoria, gli viene assegnato uno spazio di indirizzamento in memoria e si risolvono gli indirizzi assoluti (indirizzi che dipendono dall’indirizzo in cui viene il programma)</p>
<p>dopo questa fase il programma è effettivamente in esecuzione</p>
<h2 id="labels">Labels</h2>
<p>Possiamo veder le label in assembly come le variabili nei linguaggi ad alto livello.<br>
le labels prenderanno un posizione in memora RAM e noi dobbiamo specificare la dimensione che quella variabile.</p>
<p>Possiamo decidere la dimensione tramite le <strong>direttive</strong> cioè dei comandi da dare all’assemblatore in fase di compilazione. Alcune direttive sono:</p>

<table>
<thead>
<tr>
<th>direttiva</th>
<th>significato</th>
</tr>
</thead>
<tbody>
<tr>
<td>.float &lt;&gt;</td>
<td>inserisce un numero float32</td>
</tr>
<tr>
<td>.ascii &lt;&gt;</td>
<td>inserisce una stringa (non terminata dallo 0)</td>
</tr>
<tr>
<td>.asciiz &lt;&gt;</td>
<td>inserisce una stringa terminata da 0</td>
</tr>
<tr>
<td>.byte &lt;&gt;</td>
<td>inserisce un byte</td>
</tr>
<tr>
<td>.word &lt;&gt;</td>
<td>inserisce un numero da 4 byte (32bit)</td>
</tr>
<tr>
<td>.dword &lt;&gt;</td>
<td>inserisce un numero da 8 byte (64bit)</td>
</tr>
<tr>
<td>.space &lt;&gt;</td>
<td>riserva dei byte arbitrari non inizializzati</td>
</tr>
</tbody>
</table><p>Queste direttive vanno inserite nel segmento <strong>.data</strong>:</p>
<pre><code>.data
	a: word 10 //la label chiamata 'a' grande 32bit contiene il numero 10
</code></pre>
<p>Per fare le operazione con le label dobbiamo ottenere il loro indirizzo in memoria, possiamo farla grazie all’istruzione <code>adr</code></p>
<p><code>adr x0, a // ottiene l'indirizzo della label a in memoria</code></p>
<p>ora che abbiamo l’indirizzo per poter utilizzare il suo valore dobbiamo caricarlo in un registro:</p>
<p><code>ldr w1, [x0] // ora il registro w1 contiene il valore della label 'a'</code></p>
<p>Una approccio generale è quello di evitare di copiare valori tra registri e memoria, quindi conviene utilizzare tutti i registri di cui disponiamo e non continuare a sovrascrivere dati su pochi registri</p>

    </div>
  </div>
</body>

</html>
